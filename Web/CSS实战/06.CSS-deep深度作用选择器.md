---
title: CSS deep 深度作用选择器
date: 2023-02-18 11:33:00
tags:
categories:
- CSS
---

## css: deep 深度作用选择器
<https://blog.csdn.net/weixin_39357177/article/details/114371187>

Scoped CSS 规范是 Web 组件产生不污染其他组件，也不被其他组件污染的 CSS 规范。

当 `<style>` 标签有 scoped 属性时，它的 CSS 只作用于当前组件中的元素，不会影响到子组件（非根结点）的样式。

使用 scoped 后，父组件的样式将不会渗透到子组件中。不过一个子组件的根节点会同时受其父组件有作用域的 CSS 和子组件有作用域的 CSS 的影响。这样设计是为了让父组件可以从布局的角度出发，调整其子组件根元素的样式。

### 原理
在编译组件的时候，如果当前组件内 style 标签上有 scoped 属性，那么会在当前所有标签上添加一个 `data-v-hash` 属性，而当前样式表内的所有末尾选择器后面也会加上该属性，那么就使得当前组件内的样式只会作用于当前组件内的元素。

当父组件，子组件同时使用 scoped 属性时，子组件最外层的标签既会被加上当前组件的 hash 值，又会加上父级组件的 hash 值。

css 中通常会在 style 标签内添加 scoped 来避免父组件对子组件的影响，添加了之后只能修改当前组件的样式。
```html
<style scoped>
  /*...*/
</style>
```

这样做的原理是通过在打包的时候给每个样式都添加一个独一无二的 hash 值，从而避免父组件对子组件的样式的影响。

添加后控制台显示的样式就会像这样：
```css
.title[data-v-211e4c4a] {
    color: #ff0;
}
```
设置了上述 scoped 的话，如果想要在父组件中修改子组件的样式时应该怎么样做呢？

如果去掉 scoped 的话就会影响全局样式，但是加上 scoped 又不能在当前组件修改子组件的样式，这个时候就可以使用 `/deep/` 了。

`/deep/` 表示深度选择器
```html
<style scoped>
    /deep/.title{
        color: #ff0;
    }
</style>
```

除了 `/deep/` 以外， `>>>` 和 `::v-deep` 也可以实现同样的效果。

注意：`/deep/` 只能在像 less , sass 等 css 预处理器中使用，在原生 css 中使用无效，所以原生 css 当中应使用 `>>>` 。

在增加了scoped 属性的组件当中，每个标签都会带上形如 `data-v-hash` 的属性，父组件和子组件的 hash 值不一样。

按照普通的写法，编译之后的代码 hash 值对不上，所以父组件不能控制子组件（非根结点）的样式（控制子组件根结点的样式是可以的）

解决办法可以在样式中使用 `/deep/` 或者 `>>>`，使得父组件样式的作用深度更深。

---
title: Sass基础
date: 2019-02-17 09:38:00
tags:
categories:
- Sass
---

## Sass 是什么
- CSS 的一种预处理器
- 基于 CSS 进行语法扩展而成
- 提高开发效率，弥补 CSS 语法不足
- 类似工具：Less、Stylus

## Sass 安装与使用
Sass 是用 Ruby 语言开发的，必须先安装 Ruby，再安装 Sass。

### Ruby 安装
Mac 自带😁，查看 Ruby 版本：
```shell
$ ruby -v
```

### 更换国内 gem 源
RubyGems 用于安装基于 Ruby 的软件，使用 [Ruby China](https://ruby-china.org/) 镜源。

https://gems.ruby-china.com/

```shell
$ gem sources --remove https://rubygems.org/

$ gem sources -a https://gems.ruby-china.com/

$ gem sources -l
*** CURRENT SOURCES ***
https://gems.ruby-china.com/
```

### 安装 Sass

```shell
$ sudo gem install sass

$ sass -v
Ruby Sass 3.7.3
```

### 编译 Sass

#### 普通编译
```shell
//单文件
$ sass input.scss output.css
```

#### 监听编译
```shell
//单文件
$ sass --watch input.scss:output.css

//目录
$ sass --watch app/sass:public/stylesheets
```

#### 编译风格 (--style) 选项：
- nested，默认值，嵌套缩进的 CSS 代码。
- expanded，没有缩进的、扩展的 CSS 代码。
- compact，简洁格式的 CSS 代码。
- compressed，压缩后的 CSS 代码，生产环境中使用。


## Sass 语法

### 数据类型
Sass 支持 6 种主要的数据类型：
- 数字，1, 2, 13, 10px
- 字符串，有引号字符串与无引号字符串，"foo", 'bar', baz
- 颜色，blue, #04a3f9, rgba(255,0,0,0.5)
- 布尔型，true, false
- 空值，null
- 数组 (list)，用空格或逗号作分隔符，1.5em 1em 0 2em, Helvetica, Arial, sans-serif
- maps, 相当于 JavaScript 的 object，(key1: value1, key2: value2)

### 变量
通过 $ 声明变量，将反复用到的 CSS 属性值存储到变量中，然后通过变量名来引用。
```scss
$highlight-color: #F90;
$thin-highlight-border: 1px solid $highlight-color;
.selected {
    border: 1px solid $highlight-color;
}
```

变量声明与作用范围：在 CSS 规则块外定义时，在整个样式表中都可以引用；在 CSS 规则块内定义时，只能在此规则块内使用。

反复声明一个变量，只有最后一处有效且它会覆盖前面的值。

#### #{}
如果变量需要镶嵌在字符串中，用在属性或选择器上时，就必须用 #{} 包裹引用。
```scss
$side: left;

.rounded {
    border-#{$side}-radius:5px;
}
```

#### 多个变量一处声明 nth($var, index)
把多个相关的值写在一个变量里，通过 nth($var, index) 获取第 index 个值。
```scss
$linkColor: blue silver !default;

a {
    color: nth($linkColor, 1);
    &:hover {
        color: nth($linkColor, 2);
    }
}
```

### 运算符
```scss
article[role="main"] {
    float: left;
    width: 600px /960px * 100%;
}
aside[role="complementary"] {
  float: right;
  width: 300px / 960px * 100%;
}
```


### 嵌套
通过使用嵌套避免重复写选择器。
```scss
#content {
    article {
        h1 { color: #333; }
        p { margin-bottom: 1.4em; }
    }
    aside {
        background: #eee;
    }
}
```
一般地，Sass 在解析一个嵌套规则时，会把父选择器通过一个空格链接到子选择器的前面。

#### 父选择器的标识符 &
& 被父选择器直接替换，调用自身。
```scss
article a {
    color: blue;
    &:hover { color: red; }
}
```

#### 分组选择器的嵌套
```scss
.container {
    h1, h2, h3 { margin-bottom: 0.8em; }
}

nav, aside {
    a { color: blue; }
}
```

#### 子组合选择器的嵌套
```scss
article {
    > section { background: #eee; }
}
```

#### 同层组合选择器的嵌套
```scss
article {
    //同层相邻组合，紧跟在 article 之后的同层 p 元素
    + p { font-size:}
    //紧跟在 nav 之后的 article 元素
    nav + & { margin-top: 0; }

    //同层全体组合，所有跟在 article 之后的同层 article 元素
    ~ article { border-top: 1px dashed #ccc; }
}
```

#### 属性嵌套
把属性名从中划线 - 的地方断开，在根属性后面添加一个冒号 :，紧跟一个 { } 块，把子属性部分写在这个 { } 块中。
```scss
nav {
    border: {
        style: solid;
        width: 1px;
        color: #ccc;
    }
}
```

### 导入 Sass 文件
使用 Sass 的 @import 规则在生成 CSS 时就把相关文件导入进来，可以省略 .sass 或 .scss 文件后缀。

#### 使用 Sass 局部文件
Sass 局部文件的文件名以下划线开头，专门为 @import 命令而编写，在编译时不会单独编译这个文件。 @import 导入局部文件时，可以省略文件名开头的下划线。
```scss
@import "themes/_night-sky.scss";
@import "themes/night-sky";
```

#### 默认变量值
使用 Sass 的 !default 标签用于变量，含义是：如果这个变量被声明赋值了，那就用它声明的值，否则就用这个默认值，避免变量覆盖。
```scss
// _img-style.scss 文件
// 变量
//---------------------------------
$imgStyleBorder: 1px solid #ccc !default; 
$imgStylePadding: 2px !default; 
$imgStyleRadius: 8px !default;

// mixin 
//---------------------------------
@mixin img-border(
    $border: $imgStyleBorder,
    $padding: $imgStylePadding
){
    border: $border; 
    padding: $padding; 
} 

@mixin img-rounded(
    $radius: $imgStyleRadius
){
    border-radius: $radius; 
}

//样式 
//--------------------------------- 
.img-border{
    @include img-border; 
}
.img-rounded{ 
    @include img-rounded;
}
```

使用 !default 无须去源文件中修改，为组件式开发带来了彻底的改变。

```scss
//style.scss 文件

//声明
$imgStylePadding: 5px;

//导入_img-style.scss
@import "img-style";
```

#### 嵌套导入
Sass 允许 @import 命令写在 CSS 规则内，局部文件会被插入到 CSS 规则内，在这个规则范围内生效。
```scss
.blue-theme {
    @import "blue-theme";
}
```

#### 使用 CSS 原生 @import 的既定规则
- @import 后跟的文件名是以 .css 结尾时；
- @import 后跟的是一个 URL 地址(http:\/\/ 或 https:\/\/)时；
- @import 后跟的是一个 url() 函数时；
- @import 后跟带有 media queries 时。

CSS 本身的 @import 规则导入文件时，每次发 http 请求去下载 CSS 文件，访问效率低。

### @media
Sass 中 @media 指令与 CSS 中用法一样，额外增加了：允许其在 CSS 规则中嵌套，编译时，@media 将被编译到文件的最外层，包含嵌套的父选择器。

```scss
.sidebar {
  width: 300px;
  @media screen and (orientation: landscape) {
    width: 500px;
  }
}
```

@media 的 queries 允许互相嵌套使用，编译时， Sass 自动添加 and。
```scss
@media screen {
  .sidebar {
    @media (orientation: landscape) {
      width: 500px;
    }
  }
}
```

### 注释
- 以"// comment "注释的内容则没有输出到对应的css文件；
- 以"/* comment */"注释的内容最后被输出到了对应的css文件中；
- 以"/*! comment */"注释的内容表示重要注释，即使压缩模式编译，也会保留，通常用于声明版权信息。

### 混合器
@mixin 封装可以重用的代码块，通过 @include 调用混合器中所有样式（复制拷贝）。

```scss
@mixin rounded-corners {
    -moz-border-radius: 5px;
    -webkit-border-radius: 5px;
    border-radius: 5px;
}

.notice {
    border: 2px solid #0a0;
    @include rounded-corners;
}
```

#### 何时使用混合器
利用混合器可以很容易地在样式表的不同地方共享样式。

#### 混合器中的 CSS 规则
混合器中不仅可以包含属性，也可以包含 CSS 规则。

#### 给混合器传参
给混合器传参，来定制混合器生成的精确样式，同时允许通过语法 $name: value 的形式指定每个参数的值。
```scss
@mixin link-colors($normal, $hover, $visited) {
    color: $normal;
    &:hover { color: $hover; }
    &:visited { color: $visited; }
}

a {
    @include link-colors(blue, red, green);
}

a {
    @include link-colors(
        $normal: blue,
        $visited: green,
        $hover: red
    );
}
```

##### 传递参数加...
在 CSS3 中一些属性(如 box-shadow、gradient) 可以设置多个值，并且多个值以“,”来隔开，使用参数名加... 来解决这个问题。

```scss
$shadow: :0 0 3px rgba(0,0,0,0.3),inset 0 0 3px rgba(255,255,255,0.3);

@mixin box-shadow($shadow...) {
    -webkit-box-shadow: $shadow; 
    -moz-box-shadow: $shadow;
    box-shadow: $shadow;
}
```

#### 默认参数值
使用 $name: default-value 的形式给参数指定默认值，默认值可以是任何有效的 CSS 属性值，也可以是其他参数的引用。
```scss
@mixin link-colors(
    $normal,
    $hover: black,
    $visited: $normal
) {
    color: $normal;
    &:hover { color: $hover; }
    &:visited { color: $visited; }
}
```


### 继承
继承是指一个选择器可以继承另一个选择器定义的所有样式。通过 @extend 语法实现。

任何 CSS 规则都可以继承其他规则。

继承仅仅会重复选择器，不会重复属性。

```scss
.error {
    color:#f00;
}
.error.button {
    border: 1px solid silver;
}
%error {  // 构建只用来要继承的选择器;
    background:#0f0;
}
.serious-error {
    @extend .error;
    @extend %error;
    border:1px solid #f00;
}
```
.serious-error 不仅会继承 .error 自身的所有的样式，任何跟 .error 有关的组合选择器样式也会被 .serious-error 以组合选择器第形式继承。

@extend 的作用是将重复使用的样式 (.error) 延伸 (extend) 给需要包含这个样式的特殊样式（.serious-error）。

```css
.error, .serious-error {
  color: #f00; }

.error.button, .button.serious-error {
  border: 1px solid silver; }

.serious-error {
  background: #0f0; }

.serious-error {
  border: 1px solid #f00; }
```

#### 占位选择器 placeholder selector
以 % 开头，与常用的 id 与 class 选择器写法类似，必须通过 @extend 指令调用。
```scss
// This ruleset won't be rendered on its own.
#context a%extreme {
  color: blue;
  font-weight: bold;
  font-size: 2em;
}

.notice {
  @extend %extreme;
}
```

```css
#context a.notice {
  color: blue;
  font-weight: bold;
  font-size: 2em; 
}
```

### 函数

与 mixin 相同，可以传递若干变量给函数作为参数，一个函数可以包含多条语句，需要调用 @return 输出结果。

```scss
$grid-width: 40px;
$gutter-width: 10px;

@function grid-width($n) {
  @return $n * $grid-width + ($n - 1) * $gutter-width;
}

#sidebar { width: grid-width(5); }
```

```css
#sidebar {
  width: 240px; }
```

### 条件语句
@if 声明后面可以跟多个 @else if 声明，或者一个 @else 声明。如果 @if 声明失败，Sass 将逐条执行 @else if 声明，如果全部失败，最后执行 @else 声明。

```scss
$type: monster;
p {
  @if $type == ocean {
    color: blue;
  } @else if $type == matador {
    color: red;
  } @else if $type == monster {
    color: green;
  } @else {
    color: black;
  }
}
```

### 循环语句
#### @for
@for 指令包含两种格式：
- @for $var from <start\> through <end\>：当使用 through 时，条件范围包含 <start\> 与 <end\> 的值；
- @for $var from <start\> to <end\>：使用 to 时条件范围只包含 <start\> 的值不包含 <end\> 的值（左闭右开）。
@for $i from 1 through 3 {
  .item-#{$i} { width: 2em * $i; }
}

#### @each
@each 指令的格式是 $var in <list\>， <list\>是一连串值。
```scss
@each $animal in puma, sea-slug, egret, salamander {
  .#{$animal}-icon {
    background-image: url('/images/#{$animal}.png');
  }
}
```

```scss
@each $animal, $color, $cursor in (puma, black, default),
                                  (sea-slug, blue, pointer),
                                  (egret, white, move) {
  .#{$animal}-icon {
    background-image: url('/images/#{$animal}.png');
    border: 2px solid $color;
    cursor: $cursor;
  }
}
```

```scss
@each $header, $size in (h1: 2em, h2: 1.5em, h3: 1.2em) {
  #{$header} {
    font-size: $size;
  }
}
```

#### @while
@while 指令重复输出格式直到表达式结果返回 false。
```scss
$i: 6;
@while $i > 0 {
  .item-#{$i} { width: 2em * $i; }
  $i: $i - 2;
}
```

## 参考
[1] http://sass-lang.com

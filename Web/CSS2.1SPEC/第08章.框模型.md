---
title: 框模型
date: 2019-02-23 11:05:51
tags:
categories:
- CSS
---

框模型(Box model)描述了为文档树(document tree)中元素而生成的矩形框，这些框会按照视觉格式化模型来排列展示。

## 框的尺寸
每一个框都有一个内容区(content erea，如文本、图像等)和可选的环绕在周围的内边距、边框和外边距区域。

![box-model](https://github.com/wyhcool/notes/blob/master/Web/CSS2.1SPEC/08_box-model.png)

四个区域(内容、内边距、边框和外边距)的每一个边界被称为边缘(edge)，所以每个框都有四个边缘：
- 内容边缘或内边缘(content edge or inner edge)，内容边缘围绕由框的宽度和高度指定的矩形，这通常取决于元素渲染内容。这四个内容边缘定义了框的 content 框。
- 内边距边缘(padding edge)，内边距边缘围绕着框的内边距。如果内边距的宽度为 0，则内边距边缘与内容边缘相同。这四个内边距边缘定义了框的 padding 框。
- 边框边缘(border edge)，边框边缘围绕着框的边框。如果边框的宽度为 0，则边框边缘与内边距边缘相同。这四个边框边缘定义了框的 border 框。
- 外边距边缘或外边缘(margin edge or outer edge)，如果外边距的宽度为 0，则外边距边缘与边框边缘相同。这四个外边距边缘定义了框的 margin 框。

内边距、边框和外边距可被打散为上右下左四个片段。

内容区域、内边距区域和边框区域的背景由生成它的元素的 background 属性指定，外边距区的背景总是透明的(transparent)。

## 外边距属性：margin-top、margin-right、margin-bottom、margin-left 和 margin
外边距属性指定了框的外边距区域的宽度。这些属性应用于所有元素，但垂直外边距在非替换行内元素上不起作用。

指定值为百分比时，按照生成框的包含块的宽度计算。<strong>这也适用于 margin-top 和 margin-bottom 属性</strong>。如果包含块的宽度依赖于当前元素，则元素布局是未定义的。

外边距属性允许负值，但特定实现可能会限制其效果。

[更多](https://github.com/wyhcool/notes/blob/master/Web/CSS%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%973/%E7%AC%AC08%E7%AB%A0.%E5%86%85%E8%BE%B9%E8%B7%9D%E8%BE%B9%E6%A1%86%E5%A4%96%E8%BE%B9%E8%B7%9D.md#%E5%A4%96%E8%BE%B9%E8%B7%9D)

### 折叠外边距
两个或多个框(可能是兄弟节点，也可能不是)之间的相邻外边距(adjoining margins)可以被合并成一个单独的外边距。通过此方式合并的外边距被称为折叠(collapse)，产生的已合并的外边距被称为折叠外边距(collapsed margin)。

[书写模式](https://github.com/wyhcool/notes/blob/master/Web/CSS%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%973/%E7%AC%AC06%E7%AB%A0.%E6%96%87%E6%9C%AC%E5%B1%9E%E6%80%A7.md#%E4%B9%A6%E5%86%99%E6%A8%A1%E5%BC%8F-writing-mode)为水平方向自上而下的方式时，即 left-right-top-bottom，垂直外边距会折叠，水平外边距不会折叠。

相邻的垂直外边距会折叠，除了：
- 根元素的框的外边距不折叠
- 如果与一个带有间隙的元素的上、下外边距相邻，则其外边距将与其后同胞的相邻外边距折叠，但不与父块的下外边距折叠。

当且仅当以下情况时，两个外边距为相邻关系：
- 两者均属于参与同一 bfc 的流内块级框(in-flow block-level boxes)
- 没有行框、没有间隙、没有内边距、没有外边距将它们分开（注意，某些零高度行框会被为此被忽略）
- 两者都属于垂直相邻的框边缘，即形成以下对中的一对：
  - 框的上外边距和它的第一个流内子框(its first in-flow child)的上外边距
  - 框的下外边距和它的下一个流内兄弟框(its next in-flow following sibling)的上外边距。
  - 如果框的高度计算值为 auto，框的下外边距和它的最后一个流内子框的下外边距
  - 一个没有建立新的 bfc 的且 min-height 计算值为 0 的框的上、下外边距和它的 height 值计算为 0 或者 auto 且非流内子框的上、下外边距

注意：不是同胞或祖先关系的元素也可以产生相邻外边距。

上述规则意味着：
- 浮动框和其他任何框的外边距不会折叠（甚至是和其流内子元素的外边距也不折叠）
- 建立了新的 bfc 的元素的外边距和其流内子元素的外边距不会折叠
- 绝对定位的框的外边距不会折叠（甚至是和其流内子元素的外边距也不折叠）
- 行内块框的外边距不会折叠（甚至是和其流内子元素的外边距也不折叠）
- 流内块级元素的下边外距总是和下一个流内块级同胞的上外边距折叠，除非这个元素间有间隙
- 如果一个流内块级元素没有上内边距、上边框，并且其第一个流内块级子元素没有间隙，则二者的上外边距折叠
- 如果一个流内块级元素没有下内边距、下边框，height 为 auto 且 min-height 为 0，并且其流内最后一个块级子元素的下外边距没有与一个有间隙的上外边距发生折叠，则二者的下外边距折叠
- 如果一个框的 min-height 为 0、没有上下边框、没有上下内边距、height 为 0 或 auto，并且不包含行框，其所有的流内子元素的外边距（如果有）折叠，则折叠其外边距

当两个或多个外边距折叠时，生成的外边距宽度是发生折叠的外边距中的宽度最大值。如果发生折叠的外边距中有负数，则为最大正数外边距减去最小负数外边距的绝对值。如果不存在正数外边距，则为零减去最小负数外边距的绝对值。

如果一个框的上下外边距相邻，即 height 为 0 时，则外边距可能穿过它而折叠(collapse through it)。在这种情况下，该元素的定位取决于它同其他外边距折叠的元素的关系。
- 如果元素的外边距和其父元素的上外边距折叠，则该元素框的上边框边缘(top border edge)与其父元素的相同。
- 否则，要么该元素的父元素的外边距不折叠，要么只有父元素的下外边距折叠，则该元素的上外边框边缘位置是假定该元素下边框非零时的位置。（没理解？）

注意：被贯穿而折叠的元素的上边框边缘的位置仅用于定位这些元素的后代，而不影响其他的外边距和其一起折叠的元素的位置。

避免框自身垂直外边距折叠：

- 建立新块格式化上下文，如 overflow: hidden
- 设置 min-height
- 设置固定高 height
- 添加文档流内（即非浮动、非绝对定位）子盒

需要注意最后一种办法，子盒要么有边框或内边距，要么有内容，否则父盒的自身垂直外边距同样会折叠。而如果子盒只有垂直外边距，该垂直外边距将同父盒的垂直外边距折叠，而不会阻止父盒自身垂直边距折叠。

## 内边距属性
内边距属性指定了框的内边距区域的宽度。

指定值为百分比时，按照生成框的包含块的宽度计算。<strong>这也适用于 padding-top 和 padding-bottom 属性</strong>。如果包含块的宽度依赖于当前元素，则元素布局是未定义的。

内边距的值不能为负值。

[更多](https://github.com/wyhcool/notes/blob/master/Web/CSS%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%973/%E7%AC%AC08%E7%AB%A0.%E5%86%85%E8%BE%B9%E8%B7%9D%E8%BE%B9%E6%A1%86%E5%A4%96%E8%BE%B9%E8%B7%9D.md#%E5%86%85%E8%BE%B9%E8%B7%9D)

## 边框属性
边框属性指定一个框的边框区域的宽度、颜色和样式。这些属性适用于所有元素。

[更多](https://github.com/wyhcool/notes/blob/master/Web/CSS%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%973/%E7%AC%AC08%E7%AB%A0.%E5%86%85%E8%BE%B9%E8%B7%9D%E8%BE%B9%E6%A1%86%E5%A4%96%E8%BE%B9%E8%B7%9D.md#%E8%BE%B9%E6%A1%86)

## 在双向上下文中行内元素的盒模型 The box model for inline elements in bidirectional context
对于每个行框，用户代理必须把为各元素生成的每个行内框按照视觉顺序（而不是逻辑顺序）显示其外边距、边框和内边距。

当元素的 direction 属性为 ltr 时，元素的第一个行框的最左边生成的框具有左外边距、左边框和左内边距，最后一个行框的最右边生成的框具有右内边距、右边框、右外边距。

当元素的 direction 属性为 rtl 时，元素的第一个行框的最右边生成的框具有右内边距、右边框和右外边距，最后一个行框的最左边生成的框具有左外边距、左边框、左内边距。


## 参考
[1] [Box model | CSS2.1 |W3C](https://www.w3.org/TR/2011/REC-CSS2-20110607/box.html)

[2] [collapse through | SegmentFault](https://segmentfault.com/q/1010000010202760)


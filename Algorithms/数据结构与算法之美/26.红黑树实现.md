---
title: 红黑树实现
date: 2022-07-31 12:15:00
tags:
categories:
- 算法
---

## 实现红黑树的基本思想
红黑树的平衡过程：遇到什么样的节点排布，我们就对应怎么去调整。只要按照这些固定的调整规则来操作，就能将一个非平衡的红黑树调整成平衡的。

一棵合格的红黑树需要满足这样几个要求：
- 根节点是黑色的；
- 每个叶子节点都是黑色的空节点，也就是说，叶子节点不存储数据；
- 任何相邻的节点都不能同时为红色，也就是说，红色节点是被黑色节点隔开的；
- 每个节点，从该节点到达其可到达的叶子节点的所有路径，都包含相同数目的黑色节点。

在插入、删除节点的过程中，第三、四点要求可能会被破坏。我们的平衡调整，实际上就是要把被破坏的第三、第四点恢复过来。

左旋(rotate left)，围绕某个节点的左旋；右旋(rotate right)，围绕某个节点的右旋。

## 插入操作的平衡调整
红黑树规定，插入的节点必须是红色的。而且，二叉查找树中新插入的节点都是放在叶子节点上的。所以，关于插入操作的平衡调整，有这样两种特殊情况：
- 如果插入节点的父节点是黑色的，那就什么都不用做，它仍然满足红黑树的定义。
- 如果插入的节点是根节点，那我们就直接改变它的颜色，把它变成黑色即可。

除此之外，其他情况都会违背红黑树的定义，于是我们就需要进行调整，调整的过程包含两种基础的操作：左右旋转和改变颜色。

红黑树的平衡调整过程是一个迭代的过程。我们把正在处理的节点叫做关注节点，关注节点会随着不停地迭代处理，而不断发生变化。最开始的关注节点就是新插入的节点。

新节点插入之后，如果红黑树的平衡被打破，那一般会有下面三种情况。我们只需要根据每种情况的特点，不断地调整，就可以让红黑树继续符合定义。

第一种情况，如果关注节点是 a，它的叔叔节点 d 是红色，我们依次执行下面的操作：
- 将关注节点 a 的父节点 b、叔叔节点 d 的颜色都设置为黑色；
- 将关注节点的 a 的祖父节点设置成红色；
- 关注节点变成 a 的祖父节点 c；
- 跳转到第二种情况或第三种情况。

第二种情况，如果关注节点是 a，它的叔叔节点 d 是黑色，关注节点 a 是其父节点 b 的右子节点，我们就依次执行下面的操作：
- 关注节点变成节点 a 的父节点 b；
- 围绕新的关注节点 b 左旋；
- 跳转到第三种情况。

第三种情况，如果关注节点是 a，它的叔叔节点 d 是黑色，关注节点 a 是其父节点 b 的左子节点，我们就依次执行下面的操作：
- 围绕关注节点 a 的祖父节点 c 右旋；
- 将关注节点 a 的父节点 b、兄弟节点 c 的颜色互换；
- 调整结束。

## 删除操作的平衡调整
删除操作的平衡调整分为两步，第一步是针对删除节点的初步调整。初步调整只是保证整棵红黑树在一个节点删除之后，仍然满足最后一条定义的要求，也就是说，每个节点，从该节点到达其可到达的叶子节点的所有路径，都包含相同数目的黑色节点；第二步是针对关注节点进行二次调整，让它满足红黑树的第三条定义，即不存在相邻的两个红色节点。

放弃

## 参考
[1] https://time.geekbang.org/column/intro/100017301?tab=catalog

[2] https://github.com/wangzheng0822/algo

---
title: 【基础篇】数据的双向绑定
date: 2019-04-05 23:30:00
tags:
categories:
- Vue
---

## 介绍
Vue.js 提供了现代 Web 开发中常见的高级功能：
- 解耦视图与数据；
- 可复用的组件；
- 前端路由；
- 状态管理；
- 虚拟 DOM (Virtual DOM)。

## 实例与数据绑定
### 实例与数据
通过构造函数 Vue 创建一个 Vue 的根示例(比如变量 app)，并启动 Vue 应用。
```javascript
var app = new Vue({
    //options
});
```

首先，必不可少的选项是 el，用于指定一个页面中已存在的 DOM 元素来挂载 Vue 实例，可以是 HTMLElement，也可以是 CSS 选择器。

挂载成功后，可以通过 app.$el 来访问该元素。

```html
<div id="app"></div>

<script>
var app = new Vue({
    el: document.getElementById('app')   //或者是 '#app'
});

//访问 el
app.$el
</script>
```

其次，通过 data 选项，可以声明应用内需要绑定的数据。建议所有会用到的数据都预先在 data 内声明，防止数据散落在业务逻辑中，难以维护。

同时，Vue 实例本身也代理了 data 选项中的所有属性。
```javascript
var app = new Vue({
    el: '#app',
    data {
        name: 'test'
    }
});

//访问 data.name
app.name
```

除了显示声明数据外，也可以指向一个已有的变量，并且它们之间默认建立了绑定。

### 生命周期
每个 Vue 实例创建时，都会经历一系列的初始化过程，同时也会调用相应的生命周期钩子，利用这些钩子，在合适的时机来执行我们的业务逻辑。

![vue-lifecycle](https://github.com/wyhcool/notes/blob/master/Web/Vue2/01-vue-lifecycle.png)

在 Vue 生命周期中，比较常用的钩子有：
- created，实例创建完成后调用，此阶段完成了数据的观测，但尚未挂载，$el 还不可用，需要初始化处理一些数据时会比较有用。
- mounted，el 挂载到实例上后调用，一般第一个业务逻辑会在这里开始。
- beforeDestroy，实例销毁之前调用，主要解绑一些使用 addEventListener 监听的事件。

这些钩子可作为选项写入 Vue 实例内，并且钩子的 this 指向调用它的 Vue 实例。

### 插值与表达式
使用双大括号 "{{ }}" 是最基本的文本插值方式，它会自动将将绑定的数据实时显示出来。

使用 v-html 指令将内容输出为 HTML，有可能导致 XSS 攻击，所以要在服务器端对用户提交的内容进行转义处理，一般将尖括号 '<'、'>' 转义。

如果需要显示 "{{ }}" 标签，而不进行替换，使用 v-pre 指令即可跳过这个元素和它的子元素的编译过程。

在 {{ }} 中，除了简单的绑定属性值外，还可以使用 JavaScript 表达式进行简单的运算、三元运算等。

注意⚠️：Vue.js 只支持单个表达式，不支持语句和流控制。另外，在表达式中，不能使用用户自定义的全局变量，只能使用 Vue 白名单内的全局变量，比如 Math 和 Date。

### 过滤器
Vue.js 支持在 {{}} 插值的尾部添加一个管道符('|')对数据进行过滤，经常用于格式化文本，过滤的规则是自定义的，通过给 Vue 实例添加选项 filters 来设置。

过滤器也可以串联，而且可以传递参数，默认第一个参数是数据本身。

提示：过滤器应当用于处理简单的文本转换，如果要实现复杂的数据变换，应该使用计算属性。


## 指令与事件
指令(directive) 是 Vue.js 模板中最常用的一项功能，它带有前缀 v-。指令的主要职责是当其表达式的值改变时，相应地将某些行为应用到 DOM 上。

数据驱动 DOM 是 Vue.js 的核心理念，所以不到万不得已时不要主动操作 DOM，只需要维护好数据，DOM 的事 Vue 会帮你优雅的处理。

v-bind 的基本用途是动态更新 HTML元素上的属性，比如 id、class 等。

v-on 用来绑定事件监听器，可以监听原生的 DOM 事件，包括 click、dblclick、keyup、mousemove 等。表达式可以是一个方法名，这些方法在 options 选项的 methods 属性内定义以函数的形式定义，函数内的 this 指向的是当前 Vue 实例本身。

表达式除了方法名，也可以直接是一个内联语句，建议在 methods 中声明方法，可读性强也好维护。

Vue.js 将 methods 里的方法也代理了，所以可以像访问数据那样来调用方法。

## 语法糖
语法糖是指在不影响功能的情况下，添加某种方法实现同样的效果，从而方便程序开发。

v-bind 指令可以省略 v-bind，直接写一个冒号 ':'。

v-on 指令可以省略 v-on，直接写一个 '@'。


## 参考
[1] 梁灏. Vue.js 实战. 清华大学出版社, 2017.
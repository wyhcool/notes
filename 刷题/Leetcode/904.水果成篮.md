---
title: 水果成篮
date: 2022-08-28 16:21:00
tags:
categories:
- 刷题
---

左右两个篮子交替：
```javascript
/**
 * @param {number[]} fruits
 * @return {number}
 */
var totalFruit = function(fruits) {
    var n = fruits.length

    var lBasket = -1
    var rBasket = -1

    var max = 0
    var count = 0

    for (var i = 0; i < n; i++) {
        if (lBasket == -1) {
            lBasket = fruits[i]
            count++
        } else if (fruits[i] === lBasket) {
            count++
        } else if (rBasket === -1) {
            rBasket = fruits[i]
            count++
        } else if (fruits[i] === rBasket) {
            count++
        } else {
            var last = fruits[i-1]
            count = 1
            while (i-1-count >= 0 && fruits[i-1-count] === last) {
                count++
            }
            lBasket = last
            rBasket = fruits[i]
            count++
        }

        max = Math.max(max, count)
    }
    return max
};
```

滑动窗口解法：使用 Map 存储最后最后一位：
```javascript
/**
 * @param {number[]} fruits
 * @return {number}
 */
var totalFruit = function(fruits) {
    var n = fruits.length
    if (n <= 2) {
        return n
    }

    // 滑动窗口 记录元素最后位置
    var map = new Map()

    var max = 0
    var left = 0

    for (var right = 0; right < n; right++) {
        if (map.size < 2) {
            // 滑动窗口未满时添加
            map.set(fruits[right], right)
        } else {
            // 滑动窗口已满
            if (map.has(fruits[right])){
                // 在滑动窗口中已存在
                map.set(fruits[right], right)
            } else {
                // 在滑动窗口中不存在
                // 移除前一个元素
                var prev = right - 1
                for (var key of map.keys()) {
                    var curr = map.get(key)
                    if (curr < prev) {
                        prev = curr
                        map.delete(key)
                    }
                }
                left = prev + 1
                map.set(fruits[right], right)
            }
        }

        max = Math.max(max, right-left+1)
    }
    return max
};
```

## 参考
[1] https://leetcode.cn/problems/fruit-into-baskets/
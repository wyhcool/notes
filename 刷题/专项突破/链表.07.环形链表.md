---
title: 环形链表
date: 2023-03-02 20:38:00
tags:
categories:
- 刷题
---

## 解题思路

1. 判断链表是否有环

可以使用快慢指针法，分别定义 fast 和 slow 指针，从头结点出发，fast 指针每次移动两个节点，slow 指针每次移动一个节点，如果 fast 和 slow 指针在途中相遇，说明这个链表有环。

为什么 fast 走两个节点，slow 走一个节点，有环的话，一定会在环内相遇呢，而不是永远的错开呢？

首先第一点：fast 指针一定先进入环中，如果 fast 指针和 slow 指针相遇的话，一定是在环中相遇，这是毋庸置疑的。

那么来看一下，为什么 fast 指针和 slow 指针一定会相遇呢？

可以画一个环，然后让 fast 指针在任意一个节点开始追赶 slow 指针，因为 fast 是走两步，slow 是走一步，其，**其实相对于 slow 来说，fast 是一个节点一个节点的靠近 slow 的**，所以 fast 一定可以和 slow 重合。


2. 如果有环，如何找到这个环的入口

假设从头结点到环形入口节点的节点数为 x。 环形入口节点到 fast 指针与 slow 指针相遇节点的节点数为 y。 从相遇节点再到环形入口节点的节点数为 z。 

那么相遇时： slow 指针走过的节点数为: `x + y`， fast 指针走过的节点数： `x + y + n (y + z)`，n 为fast指针在环内走了 n 圈才遇到slow 指针， `（y+z）`为一圈内节点的个数。

因为 fast 指针是一步走两个节点，slow 指针一步走一个节点， 所以 fast 指针走过的节点数 = slow 指针走过的节点数 * 2：

`(x + y) * 2 = x + y + n (y + z)`

两边消掉一个`（x+y）`: `x + y = n (y + z)`

因为要找环形的入口，那么要求的是 x，因为 x 表示 头结点到 环形入口节点的的距离。

所以要求 x ，将x单独放在左面：`x = n (y + z) - y` ,

再从 n(y+z) 中提出一个 （y+z）来，整理公式之后为如下公式：`x = (n - 1) (y + z) + z` 注意这里 n 一定是大于等于 1 的，因为 fast 指针至少要多走一圈才能相遇 slow 指针。

先拿 n 为 1 的情况来举例，意味着 fast 指针在环形里转了一圈之后，就遇到了 slow 指针了。

当 n 为 1 的时候，公式就化解为 `x = z`，

这就意味着，从头结点出发一个指针，从相遇节点也出发一个指针，这两个指针每次只走一个节点， 那么当这两个指针相遇的时候就是环形入口的节点。

那么 n 如果大于 1 是什么情况呢，就是 fast 指针在环形转 n 圈之后才遇到 slow 指针。

其实这种情况和 n 为 1 的时候 效果是一样的，一样可以通过这个方法找到环形的入口节点，只不过，index1 指针在环里 多转了(n-1)圈，然后再遇到index2，相遇点依然是环形的入口节点。

3. 为什么第一次在环中相遇，slow 的步数 是 `x+y` 而不是 `x + 若干环的长度 + y` 呢？

首先 slow 进环的时候，fast 一定是先进环来了。

如果 slow 进环入口，fast 也在环入口，如果 slow 和 fast 同时在环入口开始走，一定会在环入口相遇，slow 走了一圈，fast 走了两圈。

那么当 slow 进环的时候，fast 一定是在环的任意一个位置，那么 fast 指针走到环入口3的时候，已经走了 k + n 个节点，slow 相应的应该走了(k + n) / 2 个节点。

因为 k 是小于 n 的，所以 `(k + n) / 2` 一定小于 n。

也就是说 slow 一定没有走到环入口3，而 fast 已经到环入口3了。

这说明什么呢？

在 slow 开始走的那一环已经和 fast 相遇了。

fast 相对于 slow 是一次移动一个节点，所以不可能跳过去。

因此 第一次在环中相遇，slow 的 步数 是 x+y 而不是 x + 若干环的长度 + y 


## 题目列表

- [142. 环形链表 II](https://leetcode.cn/problems/linked-list-cycle-ii/)

